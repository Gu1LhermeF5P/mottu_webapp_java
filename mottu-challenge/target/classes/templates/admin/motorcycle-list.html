<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head('Gerenciar Motos')}"></head>

<body>
    <div th:replace="~{fragments/header :: navbar}"></div>

    <main class="container mx-auto p-4 lg:p-8">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold">Gerenciamento de Motos</h1>
            <a th:href="@{/admin/motorcycles/new}" class="btn btn-primary">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" /></svg>
                Nova Moto
            </a>
        </div>

        <div th:if="${successMessage}" role="alert" class="alert alert-success mb-4" th:text="${successMessage}"></div>
        <div th:if="${errorMessage}" role="alert" class="alert alert-error mb-4" th:text="${errorMessage}"></div>

        <div class="overflow-x-auto shadow-lg rounded-lg">
            <table class="table table-zebra w-full">
                <thead>
                    <tr>
                        <th>Placa</th>
                        <th>Modelo</th>
                        <th>Status</th>
                        <th>ID Moto</th>
                        <th class="text-right">Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="moto : ${motorcycles}" class="hover">
                        <td class="font-mono font-bold" th:text="${moto.licensePlate}"></td>
                        <td th:text="${moto.model}"></td>
                        <td>
                            <span class="badge"
                                  th:classappend="${moto.status.name() == 'AVAILABLE' ? 'badge-success' : (moto.status.name() == 'IN_MAINTENANCE' ? 'badge-warning' : 'badge-error')}"
                                  th:text="${moto.status.displayName}">
                            </span>
                        </td>
                        <td class="font-mono text-xs" th:text="${moto.beacon != null ? moto.beacon.uuid : 'N/A'}"></td>
                        <td class="text-right space-x-2">
                            <a th:href="@{/admin/motorcycles/edit/{id}(id=${moto.id})}" class="btn btn-sm btn-outline btn-info">Editar</a>
                            <button th:attr="onclick=|document.getElementById('delete_modal_${moto.id}').showModal()|" class="btn btn-sm btn-outline btn-error">Excluir</button>
                            
                            <dialog th:id="'delete_modal_' + ${moto.id}" class="modal">
                                <div class="modal-box">
                                    <h3 class="font-bold text-lg">Confirmar Exclusão</h3>
                                    <p class="py-4" th:text="'Tem certeza que deseja excluir a moto de placa ' + ${moto.licensePlate} + '?'"></p>
                                    <div class="modal-action">
                                        <form method="dialog">
                                            <button class="btn">Cancelar</button>
                                        </form>
                                        <a th:href="@{/admin/motorcycles/delete/{id}(id=${moto.id})}" class="btn btn-error">Excluir</a>
                                    </div>
                                </div>
                            </dialog>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>
</body>
</html>